const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-Dk7sD-8f.js","./vendor-wh6nDqRL.js","./vendor-DSUjwVfg.css","./index-RlQq_KYk.css"])))=>i.map(i=>d[i]);
var ne=Object.defineProperty;var ie=(i,e,t)=>e in i?ne(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var u=(i,e,t)=>ie(i,typeof e!="symbol"?e+"":e,t);import{d as L,o as P,c as x,a as F,u as M,b as E,R as re,r as W,n as Y,e as m,f as O,g as oe,t as $,w as K,E as B,h as j,i as V,G as le,j as k,k as ae,l as ce,m as ue,p as de,q as he,s as fe}from"./vendor-wh6nDqRL.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const pe={class:"app-box"},me=L({__name:"App",setup(i){return P(()=>{document.body.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1})}),(e,t)=>(E(),x("div",pe,[F(M(re))]))}}),R=(i,e)=>{const t=i.__vccOpts||i;for(const[s,n]of e)t[s]=n;return t},_e=R(me,[["__scopeId","data-v-7e1bf8ac"]]),ge="modulepreload",ve=function(i,e){return new URL(i,e).href},J={},ye=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){const l=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),a=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=ve(c,s),c in J)return;J[c]=!0;const _=c.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(!!s)for(let S=l.length-1;S>=0;S--){const d=l[S];if(d.href===c&&(!_||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${v}`))return;const w=document.createElement("link");if(w.rel=_?"stylesheet":ge,_||(w.as="script"),w.crossOrigin="",w.href=c,a&&w.setAttribute("nonce",a),document.head.appendChild(w),_)return new Promise((S,d)=>{w.addEventListener("load",S),w.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return n.then(l=>{for(const r of l||[])r.status==="rejected"&&o(r.reason);return e().catch(o)})};function T(i){if(i===null||typeof i!="object")return i;if(Array.isArray(i))return i.map(s=>T(s));const e={};for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=T(i[t]));return e}class G{constructor(e=[]){this.values=e}sum(){let e=0;for(const t of this.values)e+=t;return e}mean(){let e=0,t=0;for(const s of this.values)typeof s<"u"&&s!==null&&(e+=s,t++);if(t!==0)return e/t}median(){if(this.values.length===0)return;const e=this.values.slice(0).sort(function(n,o){return n-o}),t=Math.floor(e.length/2);return e.length%2===0?(e[t]+e[t-1])/2:e[t]}min(){return Math.min.apply(null,this.values)}max(){return Math.max.apply(null,this.values)}count(){return this.values.length}variance(){const e=this.mean();if(e===void 0)return;let t=0;for(const n of this.values)t+=Math.pow(n-e,2);return t/(this.values.length-1)}sd(){const e=this.variance();return e===void 0?void 0:Math.sqrt(e)}frequencies(){const e={};for(const t of this.values)typeof e[t]>"u"?e[t]=1:e[t]++;return e}all(e){for(const t of this.values)if(!e(t))return!1;return!0}subset(e){const t=[];for(const s of this.values)e(s)&&t.push(s);return new G(t)}}function we(i,e){const t=new Blob([i],{type:"text/plain"});let s="";typeof window.webkitURL<"u"?s=window.webkitURL.createObjectURL(t):s=window.URL.createObjectURL(t);const n=document.createElement("a");n.id="jspsych-download-as-text-link",n.style.display="none",n.download=e,n.href=s,n.click()}function be(i){const e=typeof i!="object"?JSON.parse(i):i;let t="",s="";const n=[];for(const o of e)for(const l in o){let r=l+"";r='"'+r.replace(/"/g,'""')+'",',n.includes(l)||(n.push(l),t+=r)}t=t.slice(0,-1),s+=t+`\r
`;for(const o of e){t="";for(const l of n){let r=typeof o[l]>"u"?"":o[l];typeof r=="object"&&(r=JSON.stringify(r));const a=r+"";t+='"'+a.replace(/"/g,'""')+'",'}t=t.slice(0,-1),s+=t+`\r
`}return s}function ke(){const i=window.location.search.slice(1).split("&"),e={};for(let t=0;t<i.length;++t){const s=i[t].split("=",2);s.length==1?e[s[0]]="":e[s[0]]=decodeURIComponent(s[1].replace(/\+/g," "))}return e}class y{constructor(e=[]){u(this,"trials");this.trials=e}push(e){return this.trials.push(e),this}join(e){return this.trials=this.trials.concat(e.values()),this}top(){return this.trials.length<=1?this:new y([this.trials[this.trials.length-1]])}first(e=1){if(e<1)throw`You must query with a positive nonzero integer. Please use a
               different value for n.`;return this.trials.length===0?new y:(e>this.trials.length&&(e=this.trials.length),new y(this.trials.slice(0,e)))}last(e=1){if(e<1)throw`You must query with a positive nonzero integer. Please use a
               different value for n.`;return this.trials.length===0?new y:(e>this.trials.length&&(e=this.trials.length),new y(this.trials.slice(this.trials.length-e,this.trials.length)))}values(){return this.trials}count(){return this.trials.length}readOnly(){return new y(T([this.trials]))}addToAll(e){for(const t of this.trials)Object.assign(t,e);return this}addToLast(e){return this.trials.length>0&&Object.assign(this.trials[this.trials.length-1],e),this}filter(e){let t;Array.isArray(e)?t=T(e):t=T([e]);const s=[];for(const n of this.trials){let o=!1;for(const l of t){let r=!0;for(const a of Object.keys(l))typeof n[a]<"u"&&n[a]===l[a]||(r=!1);if(r){o=!0;break}}o&&s.push(n)}return new y(s)}filterCustom(e){return new y(this.trials.filter(e))}filterColumns(e){return new y(this.trials.map(t=>Object.fromEntries(e.filter(s=>s in t).map(s=>[s,t[s]]))))}select(e){const t=[];for(const s of this.trials)typeof s[e]<"u"&&t.push(s[e]);return new G(t)}ignore(e){Array.isArray(e)||(e=[e]);const t=T(this.trials);for(const s of t)for(const n of e)delete s[n];return new y(t)}uniqueNames(){const e=[];for(const t of this.trials)for(const s of Object.keys(t))e.includes(s)||e.push(s);return e}csv(){return be(this.trials)}json(e=!1){return e?JSON.stringify(this.trials,null,"	"):JSON.stringify(this.trials)}localSave(e,t){e=e.toLowerCase();let s;if(e==="json")s=this.json();else if(e==="csv")s=this.csv();else throw new Error('Invalid format specified for localSave. Must be "json" or "csv".');we(s,t)}}class Le{constructor(){u(this,"results",new y);u(this,"dataProperties",{});u(this,"queryString",{});this.reset()}reset(){this.results=new y,this.dataProperties={},this.queryString={}}get(){return this.results}write(e){Object.assign(e,this.dataProperties),this.results.push(e)}addProperties(e){this.results.addToAll(e),this.dataProperties=Object.assign({},this.dataProperties,e)}addDataToLastTrial(e){this.results.addToLast(e)}urlVariables(){return Object.keys(this.queryString).length==0&&(this.queryString=ke()),this.queryString}getURLVariable(e){return this.urlVariables()[e]}getDisplayData(e="json"){return e=e.toLowerCase(),e!=="json"&&e!=="csv"&&(console.log("Invalid format declared for displayData function. Using json as default."),e="json"),e==="json"?this.results.json(!0):this.results.csv()}getLastTrialData(){return this.results.top()}}class xe{constructor(){u(this,"dom",document.documentElement);u(this,"listeners",new Set);u(this,"holdKey",new Set);u(this,"CaseSensority",!1);this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this)}transforCaseToLower(e){return this.CaseSensority?e:e.toLowerCase()}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}removeAllListener(){this.listeners.clear()}isKeyPress(e){return this.holdKey.has(this.transforCaseToLower(e))}handleKeyDown(e){const t=h.instance.currTime,{key:s}=e;for(const n of this.listeners)n(e,t);this.holdKey.add(this.transforCaseToLower(s))}handleKeyUp(e){const{key:t}=e;this.holdKey.delete(this.transforCaseToLower(t))}registerListener(){this.dom.addEventListener("keydown",this.handleKeyDown),this.dom.addEventListener("keyup",this.handleKeyUp)}destoryListener(){this.dom.removeEventListener("keydown",this.handleKeyDown),this.dom.removeEventListener("keyup",this.handleKeyUp)}}class Ee{constructor(){u(this,"timeout_handlers",[]);u(this,"interval_handlers",[])}setTimeout(e,t){const s=window.setTimeout(e,t);return this.timeout_handlers.push(s),s}setInterval(e,t){const s=window.setInterval(e,t);return this.interval_handlers.push(s),s}clearAllTimer(){for(const e of this.timeout_handlers)clearTimeout(e);for(const e of this.interval_handlers)clearInterval(e);this.timeout_handlers=[],this.interval_handlers=[]}}var I=(i=>(i[i.PENDING=0]="PENDING",i[i.RUNNING=1]="RUNNING",i[i.PAUSED=2]="PAUSED",i[i.COMPLETED=3]="COMPLETED",i[i.ABORTED=4]="ABORTED",i))(I||{});function Se(i,e,t=!1){const s=Array.isArray(i),n=Array.isArray(e);if(!s)n?(e=[e[0]],console.log("Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.")):(i=[i],e=[e]);else if(n){if(i.length!=e.length)if(console.warn("Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected."),e.length<i.length){let r=[];for(let a=0;a<i.length;a++)r.push(e);e=r}else e=e.slice(0,i.length)}else{let r=[];for(let a=0;a<i.length;a++)r.push(e);e=r}let o=[];for(let r=0;r<i.length;r++)for(let a=0;a<e[r];a++)i[r]==null||typeof i[r]!="object"?o.push(i[r]):o.push(Object.assign({},i[r]));let l=U(o);return t&&(l=Ie(l)),l}function U(i){Array.isArray(i)||console.error("Argument to shuffle() must be an array.");const e=i.slice(0);let t=e.length,s,n;for(;t;)n=Math.floor(Math.random()*t--),s=e[t],e[t]=e[n],e[n]=s;return e}function Ae(i,e=!1){const t=i.length;if(t==1)return console.warn("shuffleAlternateGroups() was called with only one group. Defaulting to simple shuffle."),U(i[0]);let s=[];for(let r=0;r<t;r++)s.push(r);e&&(s=U(s));const n=[];let o=-1;for(let r=0;r<t;r++)o=o===null?i[r].length:Math.min(o,i[r].length),n.push(U(i[r]));const l=[];for(let r=0;r<o;r++)for(let a=0;a<s.length;a++)l.push(n[s[a]][r]);return l}function Te(i,e){return Array.isArray(i)||console.error("First argument to sampleWithoutReplacement() must be an array"),e>i.length&&console.error("Cannot take a sample larger than the size of the set of items to sample."),U(i).slice(0,e)}function Re(i,e,t){Array.isArray(i)||console.error("First argument to sampleWithReplacement() must be an array");const s=[];if(typeof t<"u"){t.length!==i.length&&console.error("The length of the weights array must equal the length of the array to be sampled from.");let l=0;for(const r of t)l+=r;for(const r of t)s.push(r/l)}else for(let l=0;l<i.length;l++)s.push(1/i.length);const n=[s[0]];for(let l=1;l<s.length;l++)n.push(s[l]+n[l-1]);const o=[];for(let l=0;l<e;l++){const r=Math.random();let a=0;for(;r>n[a];)a++;o.push(i[a])}return o}function Ie(i){const e={};for(const t of i)for(const s of Object.keys(t))typeof e[s]>"u"&&(e[s]=[]),e[s].push(t[s]);return e}class Z{constructor(){u(this,"index")}}class Oe extends Z{constructor(t,s,n=0){super();u(this,"description");u(this,"results");u(this,"id");u(this,"trial_start_time",-1);u(this,"trial_finish_time",-1);this.parent=s,this.description=t,this.results=[],this.id=n}run(){this.description.on_start&&this.description.on_start(this);const t=typeof this.description.component=="function"?this.description.component(this):this.description.component;W(t,this.parent.getDisplayDom()),Y(()=>{this.trial_start_time=h.instance.currTime,this.description.on_load&&this.description.on_load(t)})}finish(t){h.plugin.timer.clearAllTimer(),h.plugin.keyboard.removeAllListener(),W(null,this.parent.getDisplayDom()),Y(()=>{this.trial_finish_time=h.instance.currTime,Object.assign(t,{trial_id:this.getCurrId(),trial_start_time:this.trial_start_time,trial_finish_time:this.trial_finish_time}),this.description.on_finish&&this.description.on_finish(t),this.write(t),this.parent.getTopTimeline().next(),this.parent.getTopTimeline().run()})}getIntervalTime(t){return t-this.trial_start_time}getCurrId(){return`${this.parent.getCurrId()}-${this.id}`}getResults(){return this.results}write(t){this.results.push(t),h.instance.data.write(t)}}class b extends Z{constructor(t,s,n=0){super();u(this,"description");u(this,"childNodes");u(this,"timeline_variables");u(this,"id");u(this,"status",I.PENDING);u(this,"cursor_node",0);u(this,"cursor_variable",0);u(this,"cursor_repetition",0);this.parent=s,this.id=n,this.description=Array.isArray(t)?{timeline:t}:t,this.childNodes=this.description.timeline.map((o,l)=>Object.hasOwn(o,"timeline")?new b(o,this,l):new Oe(o,this,l)),this.timeline_variables=this.generateTimelineVariableOrder(),this.reset()}reset(){this.cursor_node=0,this.cursor_variable=0,this.cursor_repetition=0;for(const t of this.childNodes)t instanceof b&&t.reset();this.status=I.RUNNING}run(){if(this.status!==I.RUNNING)return 0;const{conditional_function:t}=this.description;(!t||t())&&(this.description.on_timeline_start&&this.description.on_timeline_start(),this.childNodes[this.cursor_node].run(),this.description.on_timeline_finish&&this.description.on_timeline_finish())}next(){if(this.status!==I.RUNNING)return 0;const{loop_function:t,repetitions:s=1}=this.description;if(this.childNodes[this.cursor_node]instanceof b){const n=this.childNodes[this.cursor_node];if(n.next(),n.getStatus()===I.RUNNING)return 0}if(this.cursor_node+=1,this.cursor_node>=this.childNodes.length&&(this.cursor_node=0,this.cursor_variable+=1,this.cursor_variable&&this.cursor_variable%this.timeline_variables.length===0)){if(this.cursor_variable=0,this.cursor_repetition+=1,this.cursor_repetition>=s){if(t&&t(new y(this.getResults()))){for(const n of this.childNodes)n instanceof b&&n.reset();return this.reset(),0}return this.status=I.COMPLETED,0}this.timeline_variables=this.generateTimelineVariableOrder()}}getCurrId(){let t=[];return this.parent instanceof b&&t.push(...this.parent.getCurrId().split("-")),t.push(this.id),t.join("-")}getTopTimeline(){return this.parent instanceof b?this.parent.getTopTimeline():this}getActivateTrial(){const t=this.childNodes[this.cursor_node];return t instanceof b?t.getActivateTrial():t}getStatus(){return this.status}getResults(){const t=[];for(const s of this.childNodes)t.push(...s.getResults());return t}getDisplayDom(){return this.parent instanceof b?this.parent.getDisplayDom():this.parent}generateTimelineVariableOrder(){var o;const t=(o=this.description.timeline_variables)==null?void 0:o.length;if(!t)return[-1];let s=[...Array(t).keys()];const n=this.description.sample;if(n)switch(n.type){case"custom":s=n.fn(s);break;case"with-replacement":s=Re(s,n.size,n.weights);break;case"without-replacement":s=Te(s,n.size);break;case"fixed-repetitions":s=Se(s,n.size);break;case"alternate-groups":s=Ae(n.groups,n.randomize_group_order);break}return this.description.randomize_order&&(s=U(s)),s}getAllTimelineVariables(){return{...this.parent instanceof b?this.parent.getAllTimelineVariables():{},...this.description.timeline_variables?this.description.timeline_variables[this.cursor_variable]:{}}}}const A=class A{constructor(){u(this,"timeline");u(this,"data",new Le);this.data.reset(),this.timeline=new b([],document.documentElement),A.plugin.keyboard.registerListener()}load(e,t){this.timeline=new b(e,t)}next(){this.timeline.next()}run(){this.timeline.run()}get currTrial(){return this.timeline.getActivateTrial()}get currTime(){return new Date().getTime()}static get instance(){return A.only_instance===void 0&&(A.only_instance=new A),A.only_instance}};u(A,"only_instance"),u(A,"plugin",{timer:new Ee,keyboard:new xe});let h=A;const je=L({__name:"endExp",emits:["end"],setup(i,{emit:e}){const t=e;return(s,n)=>(E(),x("div",{class:"end-exp",onClick:n[0]||(n[0]=o=>{t("end")})},n[1]||(n[1]=[m("div",{class:"content-box"},[m("div",{class:"title"},"实验结束"),m("div",{class:"desc"},"点击下载数据")],-1),m("div",{class:"footer"}," © Mupsy 技术支持 ",-1)])))}}),Ne=R(je,[["__scopeId","data-v-6ae1f16f"]]),De=["innerHTML"],Ue=L({__name:"HtmlKeyboard",props:{stimulus:{type:String,default:""},stimulus_duration:{type:Number,default:0},trial_duration_time:{type:Number,default:0},response_ends_trial:{type:Boolean,default:!0},choices:{type:Array,default:["ALL_KEYS"]}},setup(i){const e=i,t=(o,l)=>{const r=h.plugin.keyboard.transforCaseToLower(o.key);if(e.choices.indexOf("NO_KEYS")>=0)return 0;if(e.choices.indexOf("ALL_KEYS")>=0||e.choices.indexOf(r)>=0){const a={rt:h.instance.currTrial.getIntervalTime(l),response:r,stimulus:e.stimulus};s(!1,a)}};h.plugin.keyboard.addListener(t);const s=(o=!1,l={})=>{const r={trial_type:"html-keyboard",...l};e.response_ends_trial&&!o&&h.instance.currTrial.finish(r),o&&h.instance.currTrial.finish(r)},n=O();return P(()=>{e.trial_duration_time>0&&h.plugin.timer.setTimeout(()=>{s(!0)},e.trial_duration_time),e.stimulus_duration>0&&h.plugin.timer.setTimeout(()=>{var o,l;(o=n.value)==null||o.classList.add("hidden"),(l=n.value)==null||l.attributes.setNamedItem(document.createAttribute("hidden"))},e.stimulus_duration)}),(o,l)=>(E(),x("div",{class:"plugin-box",ref_key:"dom",ref:n},[m("div",{innerHTML:e.stimulus},null,8,De)],512))}}),Pe=R(Ue,[["__scopeId","data-v-4a9fe79f"]]),Ce={class:"plugin-box"},$e=L({__name:"ImgSelectAndroid",props:{imgL:{type:String,default:""},imgR:{type:String,default:""}},setup(i){let e=0,t=0,s=[];const n=i,o=O(800),l=O(300),r=O(!1),a=()=>{const{clientWidth:d,clientHeight:f}=document.documentElement;o.value=Math.min(d*.8,800),l.value=f*.8,f>d?r.value=!0:r.value=!1,c.value&&(c.value.width=o.value,c.value.height=l.value),S()},c=O(),_=d=>{const f=new Date().getTime()-t,{top:p,left:g}=c.value.getBoundingClientRect(),{clientX:z,clientY:D}=d,{x:te,y:se}={x:z-g,y:D-p};if(t===0||f<100){e+=1;return}const H=N(te,se);H?h.instance.currTrial.finish({trial_type:"img_select",rt:f,response:H,invalid_click:e}):e+=1},v=d=>{const{key:f}=d,p=new Date().getTime()-t;if(t===0||p<100){e+=1;return}f=="ArrowLeft"?h.instance.currTrial.finish({trial_type:"img_select",rt:p,response:"left",invalid_click:e}):f=="ArrowRight"?h.instance.currTrial.finish({trial_type:"img_select",rt:p,response:"right",invalid_click:e}):e+=1};h.plugin.keyboard.addListener(v);const N=(d,f)=>{const p=w("left"),g=w("right");if(d>p.x&&d<p.x+p.w&&f>p.y&&f<p.y+p.h)return"left";if(d>g.x&&d<g.x+g.w&&f>g.y&&f<g.y+g.h)return"right"},w=d=>{const p=(r.value?l.value:o.value)-100,g=r.value?o.value:l.value;return p/2>=g?{x:r.value||d=="left"?0:p-g+100,y:r.value?d=="left"?0:p-g+100:0,w:g,h:g}:{x:r.value?(g-p/2)/2:d=="left"?0:p/2+100,y:r.value?d=="left"?0:p/2+100:(g-p/2)/2,w:p/2,h:p/2}},S=()=>{if(s.length<2||!c.value)return;const d=c.value.getContext("2d");if(!d)return;d.clearRect(0,0,o.value,l.value);const f=10;s.forEach(p=>{const{img:g,pos:z}=p,D=w(z);d.drawImage(g,f,f,g.width-f*2,g.height-f*2,D.x,D.y,D.w,D.h)})};return P(()=>{document.documentElement.addEventListener("pointerdown",_),window.addEventListener("resize",a);const d=new Image;d.src=n.imgL,d.onload=()=>{s.push({img:d,pos:"left"}),t=new Date().getTime(),S()};const f=new Image;f.src=n.imgR,f.onload=()=>{s.push({img:f,pos:"right"}),t=new Date().getTime(),S()},a()}),oe(()=>{document.documentElement.removeEventListener("pointerdown",_),window.removeEventListener("resize",a)}),(d,f)=>(E(),x("div",Ce,[m("canvas",{ref_key:"render",ref:c},null,512)]))}}),Q=R($e,[["__scopeId","data-v-78852dda"]]),Fe={class:"plugin-box"},Me={class:"button-box"},qe=L({__name:"Rest",setup(i){const e=t=>{h.instance.currTrial.finish({trial_type:"judge_trial",go:t})};return(t,s)=>(E(),x("div",Fe,[m("div",Me,[s[1]||(s[1]=m("div",{class:"text"},"休息一下吧，当你休息完成后，点击继续按钮",-1)),s[2]||(s[2]=m("div",{class:"text"},"注意不要关闭本页面！",-1)),m("div",{class:"button",onClick:s[0]||(s[0]=n=>e(!0))},"继续")])]))}}),ze=R(qe,[["__scopeId","data-v-cbcf1880"]]),Ke={class:"plugin-box"},Be={class:"title"},Ve=L({__name:"EnterFullScreen",props:{model:{type:Boolean,default:!1},msg:{type:String,default:"欢迎参与实验"},button_label:{type:String,default:"点击进入全屏"}},setup(i){const e=i,t=()=>{const s=document,n=document.documentElement;e.model&&!s.fullscreenElement&&!s.webkitFullscreenElement&&!s.mozFullScreenElement&&!s.msFullscreenElement&&(n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen()),!e.model&&(s.fullscreenElement||s.webkitFullscreenElement||s.mozFullScreenElement||s.msFullscreenElement)&&(s.exitFullscreen?s.exitFullscreen():s.webkitExitFullscreen?s.webkitExitFullscreen():s.mozCancelFullScreen?s.mozCancelFullScreen():s.msExitFullscreen&&s.msExitFullscreen()),h.instance.currTrial.finish({trial_type:"fullscreen"})};return P(()=>{e.model||t()}),(s,n)=>(E(),x("div",Ke,[m("div",Be,$(e.msg),1),F(M(B),{onClick:t},{default:K(()=>[j($(e.button_label),1)]),_:1})]))}}),X=R(Ve,[["__scopeId","data-v-b4aa58d6"]]),Ge={class:"plugin-box"},He=L({__name:"instr_prac",setup(i){const e=()=>{h.instance.currTrial.finish({trial_type:"instruction_prac"})};return(t,s)=>(E(),x("div",Ge,[s[1]||(s[1]=m("div",{class:"title"},"实验说明",-1)),s[2]||(s[2]=m("div",null,[j("接下来你会看到两个图片，你需要选择两个当中最符合"),m("strong",null,"女性化面孔"),j("的图片")],-1)),s[3]||(s[3]=m("div",null,"你可以用触屏、鼠标点击、键盘左右按键来选择你认为较为女性化的面孔",-1)),s[4]||(s[4]=m("div",null,"点击继续，进入练习阶段",-1)),F(M(B),{type:"primary",onClick:e},{default:K(()=>s[0]||(s[0]=[j("继续")])),_:1})]))}}),We=R(He,[["__scopeId","data-v-90af49c7"]]),Ye={class:"plugin-box"},Je=L({__name:"instr_form",setup(i){const e=()=>{h.instance.currTrial.finish({trial_type:"instruction_form"})};return(t,s)=>(E(),x("div",Ye,[s[1]||(s[1]=m("div",{class:"title"},"实验说明",-1)),s[2]||(s[2]=m("div",null,[j("接下来你会看到两个图片，你需要选择两个当中最符合"),m("strong",null,"女性化面孔"),j("的图片")],-1)),s[3]||(s[3]=m("div",null,"你可以用触屏、鼠标点击、键盘左右按键来选择你认为较为女性化的面孔",-1)),s[4]||(s[4]=m("div",null,"点击继续，进入正式实验",-1)),F(M(B),{type:"primary",onClick:e},{default:K(()=>s[0]||(s[0]=[j("继续")])),_:1})]))}}),Qe=R(Je,[["__scopeId","data-v-bf639c9c"]]),Xe=V("loader-assets-to-blobs",{state(){return{_running:!1,tmpSet:new Set,blobMap:new Map,loading:0}},getters:{isInit(){return!!this.blobMap.size},isRunning(){return this._running},isFinish(){return!this.tmpSet.size},progress(){return{len:this.tmpSet.size+this.blobMap.size,left:this.tmpSet.size,loading:this.loading}}},actions:{_addAssetsToBlobAsync(i){const e=this,t=new XMLHttpRequest;t.open("GET",i,!0),t.responseType="blob",t.onload=function(){if(e.loading-=1,this.status==200){const n=this.response;e._loadSuccess(i,n)}else e._loadError(i,"Error")};let s=0;t.onprogress=n=>{this.loading+=(n.loaded-s)/n.total,s=n.loaded},t.ontimeout=function(){e._loadError(i,"Timeout!")},t.send()},_loadSuccess(i,e){this.tmpSet.delete(i),this.blobMap.set(i,URL.createObjectURL(e))},_loadError(i,e){console.warn(`load Assets Error: ${e}, url: ${i}`)},addAssets(i){this.tmpSet.add(i)},removeAssets(i){URL.revokeObjectURL(this.getAssets(i)),this.tmpSet.delete(i)},getAssets(i){const e=this.blobMap.get(i);return e||""},startLoad(){return this.isRunning?0:(this._running=!1,this.tmpSet.forEach(i=>{this._addAssetsToBlobAsync(i)}),this._running=!0,1)}}}),ee=V("browser-info",{state(){return{isInit:!1,browser:{}}},actions:{init(){le.getInfo().then(i=>{Object.keys(i).forEach(e=>{this.browser[e]=i[e]}),this.isInit=!0})}}}),Ze={class:"plugin-box"},et=L({__name:"Preload",props:{assets:Array},setup(i){const e=i,t=ee(),s=Xe(),n=O("0"),o=O("-1"),l=()=>{h.instance.currTrial.finish({trial_type:"perload"})};return P(()=>{var r;s.isInit?l():((r=e.assets)==null||r.forEach(a=>{s.addAssets(a)}),t.init(),s.startLoad(),h.plugin.timer.setInterval(()=>{if(t.isInit&&s.isFinish)l();else{const{len:a,left:c,loading:_}=s.progress;n.value=a.toString(),o.value=(a-c+_).toFixed(2)}},100))}),(r,a)=>(E(),x("div",Ze,[m("div",null,$(o.value)+" / "+$(n.value),1)]))}});class C{constructor(){u(this,"__preUrl","https://www.naodao.com/api");u(this,"__token","");u(this,"__id","");u(this,"__location","");u(this,"__itemId","");u(this,"__beginDate","");u(this,"getData",()=>"");this.init()}static getQueryString(e){for(var t=window.location.search.substring(1),s=t.split("&"),n=0;n<s.length;n++){var o=s[n].split("=");if(o[0]==e)return o[1]}return""}init(){var e=this,t=window.localStorage.getItem("__insula_l__"),s=t?JSON.parse(t):{};e.__beginDate=s.user&&s.user.beginDate,e.__token=C.getQueryString("__token"),e.__id=C.getQueryString("__id"),e.__itemId=C.getQueryString("__itemId"),e.__location=window.location.href,fetch(e.__preUrl+"/user/canvasNode/insertRecord",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/json"},body:JSON.stringify({nodeId:e.__id,recordId:e.__token,itemId:e.__itemId,beginDate:e.__beginDate?e.__beginDate:""})}).then(n=>n.json())}async save(){let e;this.__token==="preview"||this.__location.includes("file://")?e=this.offlineSave(this.getData()):e=await this.onlineSave(this.getData()),e?this.parent_post_message(this.__token,this.__id,!0,200,"实验作答完成，感谢你的耐心等待，继续下一步？"):this.parent_post_message(this.__token,this.__id,!1,500,"实验作答失败，请刷新重新作答！")}offlineSave(e,t=this.__id){try{const s=new Blob([e],{type:"text/plain"});let n="";typeof window.webkitURL<"u"?n=window.webkitURL.createObjectURL(s):n=window.URL.createObjectURL(s);const o=document.createElement("a");return o.id="jspsych-download-as-text-link",o.style.display="none",o.download=`${t}.csv`,o.href=n,o.click(),!0}catch{return!1}}async onlineSave(e,t=this.__id,s=this.__token){return fetch(this.__preUrl+"/user/jsPsych/results",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/json"},body:JSON.stringify({experimentId:t,token:s,key:t,value:e,state:1})}).then(n=>n.json()).then(n=>n.code==200)}parent_post_message(e,t,s,n,o){window.parent.postMessage({recordId:e,nodeId:t,isCompleted:s,code:n,message:o})}}const tt={id:"exp"},st=50,nt=150,it=L({__name:"index",setup(i){const e=h.instance,t=[],s=ee(),n=function(){const _=[];for(let v=0;v<1e4;v++)_.push(v);return _}();let o=T(n);const l={component(){return k(Pe,{stimulus:"+",stimulus_duration:500,trial_duration_time:1e3})}};t.push({component:k(et)},{component:k(X,{model:!0})});let r={isLeftAdd:!0,noise_index:-1};t.push({timeline:[{component:k(We)},{timeline:[l,{component(){return r.isLeftAdd=Math.random()>.5,k(Q,{imgL:`https://insula.oss-cn-chengdu.aliyuncs.com/2024112801/img/prac/female${r.isLeftAdd?"less":"more"}.jpg`,imgR:`https://insula.oss-cn-chengdu.aliyuncs.com/2024112801/img/prac/female${r.isLeftAdd?"more":"less"}.jpg`})},on_finish(c){const{isLeftAdd:_}=r,v=_?{left:"less",right:"more"}:{left:"more",right:"less"};Object.assign(c,{left_pos:v.left,right_pos:v.right,response_pos:v[c.response],acc:v[c.response]=="more"?1:0,save:!0,prac:!0})}}],repetitions:5}],loop_function(){const c=e.data.get().filter({prac:!0}).last(5).select("acc").mean();return c<.8&&ae.error("错误率较高，请重新练习"),c<.8}}),t.push({component:k(Qe)}),t.push({timeline:[{timeline:[l,{component(){o.length<1&&(o=T(n)),r.isLeftAdd=Math.random()>.5,r.noise_index=o.splice(Math.floor(Math.random()*o.length),1)[0];const{isLeftAdd:c,noise_index:_}=r;return k(Q,{imgL:`https://insula.oss-cn-chengdu.aliyuncs.com/2024112801/img/${c?"add":"reduce"}/${_}.jpg`,imgR:`https://insula.oss-cn-chengdu.aliyuncs.com/2024112801/img/${c?"reduce":"add"}/${_}.jpg`})},on_finish(c){const{isLeftAdd:_,noise_index:v}=r,N=_?{left:"add",right:"reduce"}:{left:"reduce",right:"add"};Object.assign(c,{noise_index:v,left_pos:N.left,right_pos:N.right,response_pos:N[c.response],save:!0})}}],repetitions:st},{component(){return k(ze)}}],loop_function(){return!(!e.data.get().filter({trial_type:"judge_trial"}).last(1).values()[0].go||e.data.get().filter({save:!0}).values().length>nt)}}),t.push({component:k(X,{model:!1})});const a=new C;return a.getData=()=>e.data.get().filter({save:!0}).csv(),t.push({component:k(Ne,{onEnd(){console.log(e.data.get().filter({save:!0}).values())}}),on_start(){e.data.write(Object.assign({},s.browser,{trial_type:"browser_check",save:!0})),a.save()}}),P(()=>{const c=document.querySelector("#exp");e.load(t,c),e.run()}),(c,_)=>(E(),x("div",tt))}}),rt=ce({history:ue("./"),routes:[{path:"/",name:"experment",component:it},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>ye(()=>import("./index-Dk7sD-8f.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)}]}),ot=V("color-scheme",{state(){return window.matchMedia("(prefers-color-scheme: dark)").matches?{colorScheme:"dark"}:{colorScheme:"light"}},getters:{currScheme(){return this.colorScheme}},actions:{switch(i){this.colorScheme=i,document.documentElement.classList.add(i)}}}),lt=de(),q=he(_e);q.use(fe);q.use(lt);q.use(rt);q.mount("#app");const at=ot();at.switch("dark");export{R as _};
